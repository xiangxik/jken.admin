<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>jken application</title>
    <meta content="webkit" name="renderer">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0"
          name="viewport">
    <link href="https://www.layuicdn.com/layui/css/layui.css" media="all" rel="stylesheet">
</head>
<body>
<div class="layui-form" lay-filter="layuiadmin-app-form-list" id="layuiadmin-app-form-list" style="padding: 20px 30px 0 0;">
    <div class="layui-form-item">
        <label class="layui-form-label">公司名称</label>
        <div class="layui-input-inline">
            <input type="text" name="name" lay-verify="required" placeholder="请输入公司名称" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">公司代号</label>
        <div class="layui-input-inline">
            <input type="text" name="code" lay-verify="required" placeholder="请输入公司代号" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">公司网站</label>
        <div class="layui-input-inline">
            <input type="text" name="website" placeholder="请输入公司网站" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">公司简介</label>
        <div class="layui-input-inline">
            <textarea name="introduction" style="width: 400px; height: 150px;" autocomplete="off" class="layui-textarea"></textarea>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">状态</label>
        <div class="layui-input-inline">
            <select name="status" lay-verify="required">
                <option value="NORMAL">正常</option>
                <option value="ARREARAGE">欠费</option>
            </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">是否停用</label>
        <div class="layui-input-inline">
            <input type="checkbox" lay-verify="required" lay-filter="disabled" name="disabled" lay-skin="switch" lay-text="已停用|启用中">
        </div>
    </div>
    <div class="layui-form-item layui-hide">
        <input type="button" lay-submit lay-filter="layuiadmin-app-form-submit" id="layuiadmin-app-form-submit" value="确认添加">
        <input type="button" lay-submit lay-filter="layuiadmin-app-form-edit" id="layuiadmin-app-form-edit" value="确认编辑">
    </div>
</div>

<script src="https://www.layuicdn.com/layui/layui.js"></script>
<script th:inline="javascript" type="text/javascript">
    var base = /*[[${#httpServletRequest.getContextPath()}]]*/"";
</script>
<script>
layui.config({
  base: base + '/static/layuiadmin/'
}).use(['table'], function () {
  var table = layui.table, form = layui.form;

  table.on('sort(jk-table)', function (obj) {
    table.reload('jk-table', {
      initSort: obj,
      where: {
        sort: obj.field + ',' + obj.type
      }
    });
  });

  table.on('toolbar(jk-table)', function (obj) {
    var checkStatus = table.checkStatus(obj.config.id);
    switch (obj.event) {
      case 'create':
        layer.open({
          type: 2
          , title: '添加公司'
          , content: 'listform.html'
          , maxmin: true
          , area: ['550px', '550px']
          , btn: ['确定', '取消']
          , yes: function (index, layero) {
            //点击确认触发 iframe 内容中的按钮提交
            var submit = layero.find('iframe').contents().find("#layuiadmin-app-form-submit");
            submit.click();
          }
        });
        break;
      case 'batchDelete':
        var data = checkStatus.data;
        console.log(data);
        break;
    };
  });

  //监听行工具事件
  table.on('tool(jk-table)', function (obj) {
    var data = obj.data;
    if (obj.event === 'del') {
      layer.confirm('真的删除行么', function (index) {
        obj.del();
        layer.close(index);
      });
    } else if (obj.event === 'edit') {
      layer.prompt({
        formType: 2
        , value: data.email
      }, function (value, index) {
        obj.update({
          email: value
        });
        layer.close(index);
      });
    }
  });

  //监听搜索
  form.on('submit(jk-search)', function (data) {
    var field = data.field;

    //执行重载
    table.reload('jk-table', {
      where: field
    });
  });

  var $ = layui.$, active = {
    batchdel: function () {
      var checkStatus = table.checkStatus('LAY-app-content-list')
        , checkData = checkStatus.data; //得到选中的数据

      if (checkData.length === 0) {
        return layer.msg('请选择数据');
      }

      layer.confirm('确定删除吗？', function (index) {

        //执行 Ajax 后重载
        /*
        admin.req({
          url: 'xxx'
          //,……
        });
        */
        table.reload('LAY-app-content-list');
        layer.msg('已删除');
      });
    },
    add: function () {

    }
  };

  $('.layui-btn.layuiadmin-btn-list').on('click', function () {
    var type = $(this).data('type');
    active[type] ? active[type].call(this) : '';
  });
});
</script>
</body>
</html>
